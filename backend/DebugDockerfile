FROM ubuntu:latest AS build

ARG conan_user
ARG conan_password
ARG conan_remote

WORKDIR /backend
COPY . .
RUN chmod +x ./util/build.sh
RUN ./util/build.sh $conan_user $conan_password $conan_remote ON

LABEL stage=build Name=zwoo_backend_build

FROM ubuntu:latest AS runner
WORKDIR /backend
COPY --from=build ./backend/build/main .
COPY --from=build ./backend/build/res/ ./res
ENTRYPOINT ["./main"]

LABEL Name=zwoo_backend Version=0.0.1
